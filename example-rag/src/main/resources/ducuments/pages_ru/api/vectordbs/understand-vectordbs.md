# Понимание векторов

![width=150, role = "right"](vector_2d_coordinates.png)

Векторы имеют размерность и направление. Например, на следующем изображении изображен двумерный вектор \[\vec{a}\] в декартовой системе координат, представленный в виде стрелки.

Головка вектора \[\vec{a}\] находится в точке \[(a_1, a_2)\]. Значение координаты **x** — это \(a_1\), а значение координаты **y** — это \(a_2\). Координаты также называются компонентами вектора.

## Сходство

Существует несколько математических формул, которые можно использовать для определения, являются ли два вектора сходными. Одной из самых интуитивно понятных для визуализации и понимания является косинусное сходство. Рассмотрим следующие изображения, показывающие три набора графиков:

![align="center",width=600](vector_similarity.png)

Векторы \[\vec{A}\] и \[\vec{B}\] считаются сходными, когда они направлены близко друг к другу, как на первом диаграмме. Векторы считаются несвязанными, когда направлены перпендикулярно друг другу, и противоположными, когда они направлены в разные стороны.

Угол между ними, \[\theta\], является хорошей мерой их сходства. Как можно вычислить угол \[\theta\]?

image:pythagorean-triangle.png[align="center",width=100, role="left", trim="10 10 10 100"]

Мы все знакомы с https://en.wikipedia.org/wiki/Pythagorean_theorem#History[теоремой Пифагора].

А что, если угол между **a** и **b** не равен 90 градусам?

Вводим https://en.wikipedia.org/wiki/Law_of_cosines[теорему косинусов].

. Теорема косинусов
****
\[
a^2 + b^2 - 2ab\cos\theta = c^2
\]
****

Следующее изображение показывает этот подход в виде векторной диаграммы:
image:lawofcosines.png[align="center",width=200]

Величина этого вектора определяется в терминах его компонентов как:

. Величина
****
\[
\vec{A} * \vec{A} = ||\vec{A}||^2 = A_1^2 + A_2^2
\]
****

Скалярное произведение между двумя векторами \[\vec{A}\] и \[\vec{B}\] определяется в терминах его компонентов как:

. Скалярное произведение
****
\[
\vec{A} * \vec{B} = A_1B_1 + A_2B_2
\]
****

Переписывание теоремы косинусов с использованием величин векторов и скалярных произведений дает следующее:

. Теорема косинусов в векторной форме
****
\[
| \vec{A} |  | ^2 + |  | \vec{B} |  | ^2 - 2 |  | \vec{A} |  |  |  | \vec{B} |  | \cos\theta = |  | \vec{C} |  | ^2 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
\]
****

Замена \[||\vec{C}||^2\] на \[||\vec{B} - \vec{A}||^2\] дает следующее:

. Теорема косинусов в векторной форме только в терминах \[\vec{A}\] и \[\vec{B}\]
****
\[
| \vec{A} |  | ^2 + |  | \vec{B} |  | ^2 - 2 |  | \vec{A} |  |  |  | \vec{B} |  | \cos\theta = |  | \vec{B} - \vec{A} |  | ^2 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
\]
****

https://towardsdatascience.com/cosine-similarity-how-does-it-measure-the-similarity-maths-behind-and-usage-in-python-50ad30aad7db[Расширяя это], мы получаем формулу для https://en.wikipedia.org/wiki/Cosine_similarity[косинусного сходства].

. Косинусное сходство
****
\[
similarity(\vec{A},\vec{B}) = \cos(\theta) = \frac{\vec{A}\cdot\vec{B}}{||\vec{A}||\cdot||\vec{B}||}
\]
****

Эта формула работает для размерностей выше 2 или 3, хотя визуализировать это сложно. Тем не менее, https://projector.tensorflow.org/[это можно визуализировать в некоторой степени]. Векторы в приложениях ИИ/МЛ часто имеют сотни или даже тысячи размерностей.

Функция сходства в более высоких размерностях с использованием компонентов вектора показана ниже. Она расширяет двумерные определения величины и скалярного произведения, приведенные ранее, до **N** размерностей, используя https://en.wikipedia.org/wiki/Summation[математическую нотацию суммирования].

. Косинусное сходство с компонентами вектора
****
\[
similarity(\vec{A},\vec{B}) = \cos(\theta) = \frac{ \sum_{i=1}^{n} {A_i  B_i} }{ \sqrt{\sum_{i=1}^{n}{A_i^2} \cdot \sum_{i=1}^{n}{B_i^2}}}
\]
****

Это ключевая формула, используемая в простой реализации векторного хранилища и может быть найдена в реализации `SimpleVectorStore`.

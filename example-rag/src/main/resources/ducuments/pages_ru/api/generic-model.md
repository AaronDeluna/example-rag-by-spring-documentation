```markdown
[[generic-model-api]]
# Generic Model API

Для обеспечения основы для всех AI моделей был создан Generic Model API. Это упрощает добавление поддержки новых AI моделей в Spring AI, следуя общему шаблону. В следующих разделах рассматривается этот API.

## Class Diagram

![width=900, align="center"](spring-ai-generic-model-api.jpg)

## Model

Интерфейс `Model` предоставляет общий API для вызова AI моделей. Он предназначен для обработки взаимодействия с различными типами AI моделей, абстрагируя процесс отправки запросов и получения ответов. Интерфейс использует дженерики Java для учета различных типов запросов и ответов, что повышает гибкость и адаптивность в различных реализациях AI моделей.

Интерфейс определяется ниже:

```java
public interface Model<TReq extends ModelRequest<?>, TRes extends ModelResponse<?>> {

	/**
	 * Выполняет вызов метода AI модели.
	 * @param request объект запроса, который будет отправлен AI модели
	 * @return ответ от AI модели
	 */
	TRes call(TReq request);

}
```

## StreamingModel

Интерфейс `StreamingModel` предоставляет общий API для вызова AI модели с потоковым ответом. Он абстрагирует процесс отправки запросов и получения потокового ответа. Интерфейс использует дженерики Java для учета различных типов запросов и ответов, что повышает гибкость и адаптивность в различных реализациях AI моделей.

```java
public interface StreamingModel<TReq extends ModelRequest<?>, TResChunk extends ModelResponse<?>> {

	/**
	 * Выполняет вызов метода AI модели.
	 * @param request объект запроса, который будет отправлен AI модели
	 * @return потоковый ответ от AI модели
	 */
	Flux<TResChunk> stream(TReq request);

}
```

## ModelRequest

Интерфейс `ModelRequest` представляет собой запрос к AI модели. Он инкапсулирует необходимую информацию, требуемую для взаимодействия с AI моделью, включая инструкции или входные данные (обобщенного типа `T`) и дополнительные параметры модели. Он предоставляет стандартизированный способ отправки запросов к AI моделям, обеспечивая включение всех необходимых деталей и их легкое управление.

```java
public interface ModelRequest<T> {

	/**
	 * Получает инструкции или входные данные, необходимые AI модели.
	 * @return инструкции или входные данные, необходимые AI модели
	 */
	T getInstructions(); // обязательный ввод

	/**
	 * Получает настраиваемые параметры для взаимодействия с AI моделью.
	 * @return настраиваемые параметры для взаимодействия с AI моделью
	 */
	ModelOptions getOptions();

}
```

## ModelOptions

Интерфейс `ModelOptions` представляет собой настраиваемые параметры для взаимодействия с AI моделями. Этот маркерный интерфейс позволяет задавать различные настройки и параметры, которые могут влиять на поведение и вывод AI моделей. Он предназначен для обеспечения гибкости и адаптивности в различных сценариях AI, гарантируя, что AI модели могут быть настроены в соответствии с конкретными требованиями.

```java
public interface ModelOptions {

}
```

## ModelResponse

Интерфейс `ModelResponse` представляет собой ответ, полученный от AI модели. Этот интерфейс предоставляет методы для доступа к основному результату или списку результатов, сгенерированных AI моделью, а также к метаданным ответа. Он служит стандартизированным способом инкапсуляции и управления выводом от AI моделей, обеспечивая легкий доступ и обработку сгенерированной информации.

```java
public interface ModelResponse<T extends ModelResult<?>> {

	/**
	 * Получает результат AI модели.
	 * @return результат, сгенерированный AI моделью
	 */
	T getResult();

	/**
	 * Получает список сгенерированных выходных данных AI моделью.
	 * @return список сгенерированных выходных данных
	 */
	List<T> getResults();

	/**
	 * Получает метаданные ответа, связанные с ответом AI модели.
	 * @return метаданные ответа
	 */
	ResponseMetadata getMetadata();

}
```

## ModelResult
```Интерфейс `ModelResult` предоставляет методы для доступа к основному выводу AI модели и метаданным, связанным с этим результатом. Он разработан для того, чтобы предложить стандартизированный и всесторонний способ обработки и интерпретации выводов, генерируемых AI моделями.

```java
public interface ModelResult<T> {

	/**
	 * Извлекает вывод, сгенерированный AI моделью.
	 * @return вывод, сгенерированный AI моделью
	 */
	T getOutput();

	/**
	 * Извлекает метаданные, связанные с результатом AI модели.
	 * @return метаданные, связанные с результатом
	 */
	ResultMetadata getMetadata();

}
```
